{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{supabase}from'../services/supabase';import{getUserRole}from'../services/auth.service';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[role,setRole]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{// Get initial session\nsupabase.auth.getSession().then(_ref2=>{var _session$user,_session$user2;let{data:{session}}=_ref2;setUser((_session$user=session===null||session===void 0?void 0:session.user)!==null&&_session$user!==void 0?_session$user:null);if(session!==null&&session!==void 0&&(_session$user2=session.user)!==null&&_session$user2!==void 0&&_session$user2.email){setRole(getUserRole(session.user.email));}setLoading(false);});// Listen for auth changes\nconst{data:{subscription}}=supabase.auth.onAuthStateChange((_event,session)=>{var _session$user3,_session$user4;setUser((_session$user3=session===null||session===void 0?void 0:session.user)!==null&&_session$user3!==void 0?_session$user3:null);if(session!==null&&session!==void 0&&(_session$user4=session.user)!==null&&_session$user4!==void 0&&_session$user4.email){setRole(getUserRole(session.user.email));}else{setRole(null);}setLoading(false);});return()=>subscription.unsubscribe();},[]);const signIn=async(email,password)=>{const{error}=await supabase.auth.signInWithPassword({email,password});return{error};};const signOut=async()=>{await supabase.auth.signOut();};const hasRole=roles=>{return role?roles.includes(role):false;};const value={user,role,loading,signIn,signOut,hasRole};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;}export{AuthContext};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","supabase","getUserRole","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","user","setUser","role","setRole","loading","setLoading","auth","getSession","then","_ref2","_session$user","_session$user2","data","session","email","subscription","onAuthStateChange","_event","_session$user3","_session$user4","unsubscribe","signIn","password","error","signInWithPassword","signOut","hasRole","roles","includes","value","Provider","useAuth","context","Error"],"sources":["/Users/samaysalunke/Documents/everything-hobby/kwabey-fab-check/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport { User } from '@supabase/supabase-js';\nimport { supabase } from '../services/supabase';\nimport { getUserRole } from '../services/auth.service';\n\ninterface AuthContextType {\n  user: User | null;\n  role: string | null;\n  loading: boolean;\n  signIn: (email: string, password: string) => Promise<{ error?: any }>;\n  signOut: () => Promise<void>;\n  hasRole: (roles: string[]) => boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<User | null>(null);\n  const [role, setRole] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Get initial session\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setUser(session?.user ?? null);\n      if (session?.user?.email) {\n        setRole(getUserRole(session.user.email));\n      }\n      setLoading(false);\n    });\n\n    // Listen for auth changes\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      setUser(session?.user ?? null);\n      if (session?.user?.email) {\n        setRole(getUserRole(session.user.email));\n      } else {\n        setRole(null);\n      }\n      setLoading(false);\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signIn = async (email: string, password: string) => {\n    const { error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n    return { error };\n  };\n\n  const signOut = async () => {\n    await supabase.auth.signOut();\n  };\n\n  const hasRole = (roles: string[]) => {\n    return role ? roles.includes(role) : false;\n  };\n\n  const value = {\n    user,\n    role,\n    loading,\n    signIn,\n    signOut,\n    hasRole,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\nexport { AuthContext };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}